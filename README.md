# MySplit Keyboard

自作の左右分割型キーボードです。
筐体（ケース）、Arduino Micro用ファームウェア、レイアウト変更用ツールのセットです。
ビルド方法はこのREADMEを参照してください。

この自作キーボードは、基盤（PCB）を使わず、空中配線するようになっています。
半田付けの難易度は高くないと思います。

![完成品の一例](https://raw.githubusercontent.com/okayumoka/mysplit/master/picture/IMG_20180529_204956.jpg)

# 特徴など

自作キーボードとしてはあまり特徴の無い、 左右分割型の格子配列です。

4x6+1配列で、Let's Splitに親指用キーが一つ増えた形です。4行版Helixと同じです。

左右で1台ずつ、計2台のProMicroを使用します。
左手側がホストのため、使用時は左手側のProMicroをUSBで接続します。
右手側のProMicroを接続しても動きません。

左右のキーボードはステレオミニケーブル（3極ケーブル）で接続します。4極ケーブルは必要ありません。
3極ケーブルでないと動かないわけではなく、4極ケーブルでも動作はします。

筐体に自前の3Dプリンターを用いる場合は、、好きな色で作ることができます。
キーキャップとのいろいろな組み合わせが楽しめます。

# 準備物

このリポジトリの内容物に加えて、以下のものが必要です。

## 部品
* ProMicroまたはその互換機 2台
* ダイオード（1N4148または1SS178）
* Cherry MX キースイッチ（または、その互換スイッチ）
* キーキャップ
* 配線用ケーブル
* [3.5mm 4極ミニジャック 基板取付用 MJ-4PP-9](http://akizukidenshi.com/catalog/g/gC-06070/)（メーカー：AVVICON ELECTRONIC CORPORATION、秋月電子で購入可能）
* 3.5mm ステレオミニケーブル（音楽用のケーブルで構いませんが、モノラルでは駄目です）
* M3ネジ 長さ8mm ×8本（筐体の蓋固定用）
* M3ネジ 長さ5mm ×2本（ProMicro固定用）

Arduino Microは左右に一つずつ、合計2台必要です。
ダイオード、キースイッチ、キーキャップはキーの数だけ必要です。

## 工具・その他
* 半田ごて、半田
* ヤスリ、カッター（筐体の微調整用）
* 瞬間接着剤
* セメダイン スーパーX
* 3Dプリンター（なくてもOK）

筐体（ケース）を印刷するために3Dプリンターを利用しますが、
無い場合は[DMM.make](https://make.dmm.com/print/)などの3Dプリントサービスを利用したのでも問題ありません。
むしろ多くの場合、そのほうが精度の高い筐体を入手できるでしょう。


## 入手先

部品、工具の入手先の一例です。

* [TALP KEYBOARD](https://talpkeyboard.stores.jp/)
  * ProMicro互換機、ダイオード、キースイッチ、キーキャップとすべて揃います。
  * AliExpressと比べるとさすがに高いですが、すぐ発送してくれる・国内配送なので安心感があります。
* [AliExpress](https://www.aliexpress.com/)
  * ダイオード以外をAliExpressで買うと一番安く収まると思います。
  * ただ中国からの購入になるため利用には注意。
* [秋月電子](http://akizukidenshi.com/catalog/default.aspx)
  * ダイオード、半田付けの道具、配線用ケーブルなどは定番の秋月で良いかと思います。
  * 3.5mm 4極ミニジャック 基板取付用 MJ-4PP-9 はここで購入してください。
  * 安く揃えるなら以下がおすすめです。
    * 高速スイッチング・ダイオード　１ＳＳ１７８（１００本入）
    * 半田ごて：ニクロムはんだこて　ＫＳ－３０Ｒ（３０Ｗ）
    * 半田：はんだ　０．８ｍｍ SD-62
    * こて台：はんだこて台　ＳＴ－１１
    * ケーブル：スズメッキ線0.6mm、耐熱電子ワイヤー2m×7色
* [Amazon](https://www.amazon.co.jp/)
  * キーキャップ、半田付けの道具などは入手できます。
  * 自分で組み立てるタイプの3Dプリンターも比較的安く手に入ります。RepRapで検索すると吉です。

3極ケーブルで接続できるにもかかわらず、ジャックに4極のものを利用しているのは、
単純に最初は4極ケーブルを使用するつもりだったからです。
もし同サイズの3.5mm ステレオミニジャックがあれば、それを利用しても問題ありません。


# ビルド手順

## 1.筐体の印刷

`case` 配下の3Dモデルが筐体となっています。
3Dプリンターか、3Dプリントサービスを利用して出力します。

自前の3Dプリンターで印刷する場合、素材はPLAがおすすめです。
キーボード筐体は平たく、薄いため、熱収縮の大きいABSで反らないように印刷することは至難の技です。

3Dプリントサービスを利用する場合は、特に素材に縛りはありませんが、
価格を考えるとナイロンが無難でしょう（2018年5月現在の値段を見る限り）。

## 2.キースイッチはめ込み

筐体の穴にCherry MXキースイッチをはめ込みます。

3Dプリンターの精度によっては穴のサイズがまちまちなので、ヤスリとカッターで調整します。
削りすぎないようにだけ注意してください。

キースイッチについている爪が引っかかるように、筐体には凹みがついていますが、
爪だけではキーキャップを交換したいときにも抜けてしまうので、
瞬間接着剤等で固定してしまうのが良いかと思います。

## 3.ミニジャック固定

3.5mm 4極ミニジャックを筐体に固定します。穴の部分は多少ヤスリで調整が必要になると思います。
固定は瞬間接着剤がおすすめです。

## 4.配線（半田付け）

回路図(`circuit_diagram`配下のファイル参照)通りに配線していきます。
ダイオードの向きに注意してください。
キースイッチから伸びている先の数字は、ProMicroのピン番号です。

回路図は、スイッチを筐体にはめ込んで裏返した状態となっています。
表から見た状態ではないので注意してください。

![回路図](https://raw.githubusercontent.com/okayumoka/mysplit/master/picture/circuit_diagram.png)

![配線した状態](https://raw.githubusercontent.com/okayumoka/mysplit/master/picture/IMG_20180529_205459.jpg)

また、ProMicroの互換品はMicro USBジャックが折れやすいものが多いですので、
セメダイン スーパーXなどで固定してしまうのがおすすめです。

## 5.ファームウェア書き込み

`firmware`配下のファームウェアをProMicroに書き込みます。
書き込みには、[Arduino IDE](https://www.arduino.cc/)などを利用してください。

Arduino IDEの使い方、スケッチの書き込み方法等はここでは解説しません。
注意点として、書き込み時に SparkFun ProMicro か Arduino Micro を選択するのを忘れないでください。

【重要】
ファームウェアは左手用と右手用で共通となっており、
書き込み時に切り替えるようになっています。
左手側に書き込む際はソースコードの `#define HOST_SIDE` を有効にします。
右手側に書き込むときは、`#define HOST_SIDE` をコメントアウトします。

書き込み後、動作確認を行ってください。

## 6.ProMicro固定、裏蓋装着

ProMicro固定用の部品とネジで固定します。
グラつくときは、固定用部品を瞬間接着剤で接着してしまうのが良いです。

その後、裏蓋をネジ止めします。

## 7.キーキャップはめ込み

お好みのキーキャップを取り付けて、完成です。

## 8.キー配列変更

キー配列の変更には、`tools/layouteditor` を使用します。

各キーをマウスでクリックして選択後、下側のキーボード部分をクリックすると、
選択したキーが割り当てられます。
Lower/Normal/Upperレイヤは、中央部のボタンによって切り替えます。

`Generate & Download`ボタンで、ソースコード（`keymap.ino`）を出力します。
出力されたファイルを、`firmware` 配下の同じ名前のファイルに上書きして、
ファームウェアを再書き込みしてください。


## License

MIT License

Copyright (c) 2018 okayu


